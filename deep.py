from keras.models import Sequential
from keras.layers import Dense
import numpy as np
from sklearn.model_selection import train_test_split
model = Sequential([    Dense(32, activation='relu', input_shape=(None,7)),    Dense(32, activation='relu'),    Dense(1, activation='sigmoid'),])
model.compile(optimizer='sgd',              loss='binary_crossentropy',              metrics=['accuracy'])
feature_vector = []

with open('final_data.csv','r') as fp:
	for i,line in enumerate(fp):
		if i == 0:
			pass
		else:
			feature_vector.append([int(x.strip()) for x in line.split(',')])


X = [x[:-1] for x in feature_vector]
Y = [y[-1] for y in feature_vector]


X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.2, random_state=0)
X_train=np.array(X_train)
y_train=np.array(y_train)



hist = model.fit(X_train, y_train,          batch_size=32, epochs=100,          validation_data=(X_test, y_test))

model.evaluate(X_test, y_test)[1]
